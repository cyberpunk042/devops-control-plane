<!-- Integrations — Kubernetes Setup Wizard
     Depends on: _integrations_setup_shared.html, _integrations_setup_k8s_helpers.html
     Sub-files in k8s_wizard/ are raw JS (no <script> tags) included via Jinja.
-->
<script>

    // ── Kubernetes Setup Wizard ─────────────────────────────────────────

    function openK8sSetupWizard() {

        // ── Helpers — aliased from _integrations_setup_k8s_helpers.html ──
        const _k8sModClass = window._k8sModClass;
        const _k8sSvcClass = window._k8sSvcClass;
        const _classifyWorkloadKind = window._classifyWorkloadKind;
        const _kindIcon = window._kindIcon;
        const _kindHint = window._kindHint;
        const _k8sImageName = window._k8sImageName;
        const _k8sPrimaryPort = window._k8sPrimaryPort;

        wizardModalOpen({
            title: '☸️ Kubernetes Setup',
            size: 'wide',
            steps: [
{% include 'scripts/k8s_wizard/_raw_step1_detect.html' %}
{% include 'scripts/k8s_wizard/_raw_step2_helpers.html' %}
{% include 'scripts/k8s_wizard/_raw_step2_volumes.html' %}
{% include 'scripts/k8s_wizard/_raw_step2_containers.html' %}
{% include 'scripts/k8s_wizard/_raw_step2_app_services.html' %}
{% include 'scripts/k8s_wizard/_raw_step2_infra.html' %}
{% include 'scripts/k8s_wizard/_raw_step2_cluster.html' %}
{% include 'scripts/k8s_wizard/_raw_step2_collectors.html' %}
{% include 'scripts/k8s_wizard/_raw_step3_review.html' %}
            ],
            onComplete: async (data) => {
                const payload = {
                    action: 'setup_k8s',
                    _services: data._services,
                    _infraDecisions: data._infraDecisions,
                    namespace: data.namespace,
                    output_dir: data.output_dir,
                    ingress: data.ingress,
                    skaffold: data.skaffold,
                    helm_chart: data.helm_chart,
                };
                await apiPost('/wizard/setup', payload);
                _projectStatusTS = 0;
                cardInvalidate('k8s');
            },
            successMessage: 'Kubernetes manifests generated!',
        });
    }

</script>
